

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Graphical User Interface Usage &mdash; qMRLab 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="qMRLab 0.1 documentation" href="index.html"/>
        <link rel="up" title="qMRlab Introduction" href="documentation.html"/>
        <link rel="prev" title="Variable Flip Angle" href="vfa_t1.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> qMRLab
          

          
            
            <img src="_static/logo-neuropoly.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="documentation.html">qMRlab Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html#features">Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#data-simulator">Data simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#data-fitting-and-visualization">Data fitting and visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#methods-available">Methods available</a><ul>
<li class="toctree-l3"><a class="reference internal" href="diffusion.html">Diffusion</a><ul>
<li class="toctree-l4"><a class="reference internal" href="diffusion.html#d-q-space">2D Q-Space</a></li>
<li class="toctree-l4"><a class="reference internal" href="diffusion.html#id1">3D Q-Space</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="fieldmaps.html">Field Maps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="fieldmaps.html#b0-dem">B0_DEM</a></li>
<li class="toctree-l4"><a class="reference internal" href="fieldmaps.html#b1-dam">B1_DAM</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="myelin.html">Myelin Imaging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="myelin.html#mtsat">MTSAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="myelin.html#mwf">MWF</a></li>
<li class="toctree-l4"><a class="reference internal" href="myelin.html#quantitative-magnetization-transfer">Quantitative Magnetization Transfer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="noise.html">Noise</a><ul>
<li class="toctree-l4"><a class="reference internal" href="noise.html#noise-level">Noise Level</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="t1_mapping.html">T1 Mapping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="t1_mapping.html#inversion-recovery">Inversion Recovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="t1_mapping.html#vfa-t1">VFA_T1</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html#getting-started">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#installing-qmrlab">Installing qMRlab</a><ul>
<li class="toctree-l3"><a class="reference internal" href="documentation.html#command-line-instructions">Command-Line Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="documentation.html#zip-download-instructions">Zip Download Instructions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="documentation.html#tests">Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="documentation.html#run-all-tests">Run all tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="documentation.html#run-test-suite">Run Test Suite</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="documentation.html#usage-guidelines">Usage Guidelines</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Graphical User Interface Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#startup">1. Startup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interface">2. Interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#menu-panel">2.1 Menu Panel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#main-panel">2.2 Main Panel</a></li>
<li class="toctree-l4"><a class="reference internal" href="#options-panel">2.3 Options Panel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-fitting">3.      Data Fitting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#data-format">3.1     Data format</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fitting-procedure">3.2     Fitting Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#viewing-the-fit-results">3.3     Viewing the fit results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#simulation">4.      Simulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">4.1.    Single Voxel Curve</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">4.2.    Sensitivity Analysis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">4.3. Multi Voxel Distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">5. Options Panel</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">5.1 Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">5.2.    Fitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">5.3. Options</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tutorial">6.      Tutorial</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#define-a-new-bssfp-protocol">6.1     Define a new bSSFP protocol</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html#citation">Citation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">qMRLab</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="documentation.html">qMRlab Introduction</a> &raquo;</li>
        
      <li>Graphical User Interface Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/gui_usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="graphical-user-interface-usage">
<h1>Graphical User Interface Usage<a class="headerlink" href="#graphical-user-interface-usage" title="Permalink to this headline">¶</a></h1>
<div class="section" id="startup">
<h2>1. Startup<a class="headerlink" href="#startup" title="Permalink to this headline">¶</a></h2>
<p>Launch matlab from the qMRLab folder. Then load the default setup by typing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">startup</span>
</pre></div>
</div>
<p>Then open the GUI by typing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qMRLab</span>
</pre></div>
</div>
</div>
<div class="section" id="interface">
<h2>2. Interface<a class="headerlink" href="#interface" title="Permalink to this headline">¶</a></h2>
<p>When you first launch qMRLab, you will be presented with a blank interface. The interface consists of three columns, or panels. On the left, you have the <em>Menu</em> panel, in the center you have the <em>Main panel</em>, and on the right, in a separate floating window, you have the <em>Options</em> panel.</p>
<div class="figure" id="id8">
<a class="reference internal image-reference" href="_images/gui_default.png"><img alt="_images/gui_default.png" src="_images/gui_default.png" style="width: 930.0px; height: 457.0px;" /></a>
<p class="caption"><span class="caption-text">Default interface with 3 panels: Menu, Main and floating Options</span></p>
</div>
<div class="section" id="menu-panel">
<h3>2.1 Menu Panel<a class="headerlink" href="#menu-panel" title="Permalink to this headline">¶</a></h3>
<p>The <em>Menu panel</em> is where you can choose the task you want to perform. It is divided in three sections: <strong>Method</strong>, <strong>qMR Data Fit</strong> and <strong>qMR Data Simulator</strong></p>
<div class="section" id="method">
<h4>2.1.1 Method<a class="headerlink" href="#method" title="Permalink to this headline">¶</a></h4>
<p>At the top, you will find a drop-down menu where you can choose the MR acquisition method that you want to be working with. An updated list of the available methods is here: <a class="reference internal" href="documentation.html#methods-available"><span class="std std-ref">Methods available</span></a></p>
<p>Note that the <em>Options</em> panel will update to the appropriate window according to your selection.
If you plan to be working mainly with a particular method, select it from the drop-down menu first, and the click on the <strong>Set Default</strong> button next to it. Next time you open qMRLab, your preferred method will be selected by default.</p>
<p>Clicking on the <strong>Open Options Panel</strong> below the method drop-down menu will open the <em>Options</em> panel window and set its position on the right side of the <em>Main</em> panel. This is useful to bring back the <em>Options</em> panel window to the front if it’s hidden behind another window, to reset its position if you have resized the windows, or to reopen it in case you closed it.</p>
</div>
<div class="section" id="qmr-data-fit">
<h4>2.1.2 qMR Data Fit<a class="headerlink" href="#qmr-data-fit" title="Permalink to this headline">¶</a></h4>
<p>Clicking on the light gray <strong>Fit qMT Data</strong> button will change the <em>Main</em> panel to the <em>Fit qMR Data</em> view. This is where you can load your data files for fitting and for viewing the resulting parameters maps.</p>
<p>Click the big <strong>Fit Data</strong> button only when you have selected your data files, set up your protocol and fitting options and are ready to begin the fitting process, which, depending on the size of your data and the method, can take from a few minutes to a couple of hours. The <strong>Save Results</strong> button will prompt you to save a .mat file with the results of your data fit. <strong>Load Results</strong> will load previously saved results and display them. Refer to this section <a class="reference internal" href="#data-fitting"><span class="std std-ref">3.      Data Fitting</span></a> for more information.</p>
</div>
<div class="section" id="qmr-data-simulator">
<h4>2.1.3 qMR Data Simulator<a class="headerlink" href="#qmr-data-simulator" title="Permalink to this headline">¶</a></h4>
<p>The three light gray buttons allows you to choose between three different data simulation mode: <strong>Single Voxel Curve</strong>, <strong>Sensitivity Analysis</strong> and <strong>Multi Voxel Distribution</strong>. Clicking on any one of these buttons will bring the corresponding interface to the <em>Main</em> panel. When any of these interfaces are active, clicking on the big dark gray <strong>Simulate Data</strong> button will launch the simulation using the current setting. The <strong>Save Results</strong> button will prompt you to save a .mat file with the current simulation results. <strong>Load Results</strong> will load previously saved simulation results and display them in the appropriate panel. Refer to this section <a class="reference internal" href="#simulation"><span class="std std-ref">4.      Simulation</span></a> for more information.</p>
<div class="section" id="single-voxel-curve">
<h5>Single Voxel Curve<a class="headerlink" href="#single-voxel-curve" title="Permalink to this headline">¶</a></h5>
<p>The <em>Single Voxel Curve</em> panel is a simple interface to simulate MR data from a single voxel, using the defined MR parameters and protocol. It is the fastest way to evaluate various acquisition protocols, the performance of the model and fitting options. Refer to section <a class="reference internal" href="#id1"><span class="std std-ref">4.1.    Single Voxel Curve</span></a> for more information.</p>
</div>
<div class="section" id="sensitivity-analysis">
<h5>Sensitivity Analysis<a class="headerlink" href="#sensitivity-analysis" title="Permalink to this headline">¶</a></h5>
<p>The <em>Sensitivity Analysis</em> simulation allows you to systematically vary one MR parameter, over a defined range and number of points, while keeping the others fixed. For each simulated data point, noise is added with a given SNR, and the fit is run multiple times while adding Gaussian noise. This allows you to evaluate the variance of the fit at each point. When the simulation is done, a plot shows any variable input parameters as the independent variable, as well as the mean values and variance of any fitted parameters. Refer to section 4.2 for more information.</p>
</div>
<div class="section" id="multi-voxel-distribution">
<h5>Multi Voxel Distribution<a class="headerlink" href="#multi-voxel-distribution" title="Permalink to this headline">¶</a></h5>
<p>The <em>Multi Voxel Distribution</em> is a tool to simulate any number of voxels, where any parameters combination are allowed to be varied simultaneously. You can choose how many voxels to simulate and which parameters are to be normally distributed, with its mean value and variance. The results can be displayed in a number of ways such as distribution histograms, scatter plots of input vs fitted parameters, error histograms, etc. Refer to 4.3 for more information.</p>
</div>
</div>
</div>
<div class="section" id="main-panel">
<h3>2.2 Main Panel<a class="headerlink" href="#main-panel" title="Permalink to this headline">¶</a></h3>
<p>The <em>Main</em> panel is where the simulation or fit results are displayed. The view for this panel changes correspondingly to the task selected in the <em>Menu</em> panel.</p>
</div>
<div class="section" id="options-panel">
<h3>2.3 Options Panel<a class="headerlink" href="#options-panel" title="Permalink to this headline">¶</a></h3>
<p>This is where you can set up all the parameters that are related to the simulation, the fitting and the protocol. The <em>Options</em> panel is displayed in a separate window than the <em>Menu</em> panel or <em>Main</em> panel. This is because each qMR acquisition method has its own particular options, and this window needs to be changed correspondingly. It can also be closed at any time, if it is not currently needed, to provide for a simpler interface. The <em>Options</em> panel consists of three sub-panels: ‘Protocol’, ‘Fitting’, and ‘Options’. At the bottom of all these sub-panels you will find buttons to <strong>Reset</strong> the changes you made, <strong>Save</strong> the current settings as a .mat file, <strong>Load</strong> a .mat file of settings, or go back to the <strong>Default</strong> settings. See section 5 for more information</p>
<div class="section" id="protocol">
<h4>2.3.1   Protocol<a class="headerlink" href="#protocol" title="Permalink to this headline">¶</a></h4>
<p>Here you define the acquisition protocol that you wish to use for simulation, or in the case of data fitting, the protocol you used to acquire the data. See section 5.1 for more information.</p>
</div>
<div class="section" id="fitting">
<h4>2.3.2   Fitting<a class="headerlink" href="#fitting" title="Permalink to this headline">¶</a></h4>
<p>This is where you set up your fitting options. The fit parameters table lists all the variables that are available for fitting in the current method, a tick box to select which variables are to be held fixed, a starting value and lower/upper bounds. Depending on the method, additional options may be available. See section 5.2 for more information.</p>
</div>
<div class="section" id="options">
<h4>2.3.3 Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h4>
<p>This is where you set up all the options related to the simulations. Depending on the qMR method, different sets of options are available (e.g. the fitting procedure, assumptions of the model, etc). More info in section 5.3.</p>
</div>
</div>
</div>
<div class="section" id="data-fitting">
<h2>3.      Data Fitting<a class="headerlink" href="#data-fitting" title="Permalink to this headline">¶</a></h2>
<p>qMRLab provides a convenient interface to fit your  data and visualize the parameters maps. To ensure that the results are successful, you’ll need to define the appropriate protocol, as it was used for data acquisition, and to format your qMR data in the way qMRLab expects it to be.</p>
<div class="section" id="data-format">
<h3>3.1     Data format<a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h3>
<p>Currently supported file types are .mat and .nii files. Your files should respect the following:</p>
<ul class="simple">
<li>For .mat files, the name of the file can be anything, but the array it contains should be named appropriately. The list of input names is case sensitive and is specified at the top of the <em>Data</em> dialog box. For example, for a qMT SPGR experiment, <em>MTdata</em> (for the actual MT data array) or <em>R1map</em> / <em>B1map</em> / <em>B0map</em> / <em>Mask</em> respectively for a R1 / B1 / B0 or Mask file.</li>
</ul>
<div class="figure" id="id9">
<a class="reference internal image-reference" href="_images/inputs.png"><img alt="_images/inputs.png" src="_images/inputs.png" style="width: 961.0px; height: 247.0px;" /></a>
<p class="caption"><span class="caption-text">Example of list of inputs for qMT SPGR experiment</span></p>
</div>
<ul class="simple">
<li>Each model will expect a different format of inputs, but in general, for single slice (2D) imaging, the main data is a 3D array with size [nx, ny, ndata], where nx/ny is the number of voxels in the x/y direction, and ndata is the number of data points for each voxel. For volume imaging (3D), data is a 4D array with size [nx, ny, nz, ndata], where nx/ny/ndata are a above, and nz is the number of voxels (or slices) in the z direction (e.g. in this example <em>MTdata</em> would have several datapoints per voxel).</li>
<li>Other files (e.g. in this example <em>R1map / B1map / B0map / Mask</em>) are formatted as [nx, ny, nz].</li>
</ul>
<p>For a more detailed description of the format required for each input, type this in the maltab window:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">help</span> <span class="n">Modelname</span>
</pre></div>
</div>
<p>where <em>Modelname</em> is name of the available models (e.g. in this example <em>help SPGR</em>). Alternatively, in the <em>Options</em> panel, you can press on the <strong>Help</strong> button</p>
</div>
<div class="section" id="fitting-procedure">
<h3>3.2     Fitting Procedure<a class="headerlink" href="#fitting-procedure" title="Permalink to this headline">¶</a></h3>
<div class="section" id="single-voxel">
<h4>3.2.1 Single voxel<a class="headerlink" href="#single-voxel" title="Permalink to this headline">¶</a></h4>
<p>This is useful when you want to preview the fit of a single voxel (note this option is only available on voxelwise computations)</p>
<ol class="arabic simple">
<li>Select the acquisition method of your data using the ‘Method’ drop-down menu in the <em>Menu</em> panel.</li>
<li>In the <em>Menu</em> panel, in the ‘Fit qMR data’ panel, enter your study ID in the ‘Study ID’ box (optional).</li>
<li>Load your data by clicking the browse button beside the ‘Data:’ line, or enter the full file path to it in the textbox.</li>
<li>You can view any of these maps by clicking its <strong>View</strong> button.</li>
</ol>
<div class="figure" id="id10">
<a class="reference internal image-reference" href="_images/view_data.png"><img alt="_images/view_data.png" src="_images/view_data.png" style="width: 962.0px; height: 856.0px;" /></a>
<p class="caption"><span class="caption-text">Example of viewing option, in this case R1map used for qMT SPGR</span></p>
</div>
<ol class="arabic simple" start="5">
<li>Define or load the appropriate protocol in the <em>Options</em> panel (see section 5.1 for details).</li>
<li>Define your fitting options in the Options panel (see section 5.2 for details).</li>
<li>You can preview the fitted curve for a selected voxel by using the <strong>View Data Fit</strong> button. Make sure a dataset is loaded by clikcing <strong>View</strong> beside the data file field</li>
<li>Click <strong>Select</strong> button in the ‘Cursor’ section to activate voxel selection mode, select a voxel to preview and click <strong>View Data Fit</strong>. You can now see the fitted curve and the parameters computed for that voxel.</li>
</ol>
<div class="figure" id="id11">
<a class="reference internal image-reference" href="_images/view_fit_1vox.png"><img alt="_images/view_fit_1vox.png" src="_images/view_fit_1vox.png" style="width: 981.0px; height: 912.0px;" /></a>
<p class="caption"><span class="caption-text">Example of fitting in 1 voxel, which was selected with the cursor on the image.</span></p>
</div>
</div>
<div class="section" id="whole-dataset">
<h4>3.2.2 Whole dataset<a class="headerlink" href="#whole-dataset" title="Permalink to this headline">¶</a></h4>
<p>Follow steps 1-6 above, then</p>
<ol class="arabic simple" start="7">
<li>In the <em>Menu</em> panel, click on <strong>Fit data</strong> to start the fitting process.</li>
<li>Once the fitting is done, a temporary file will be saved in the ‘FitResults’ subfolder of the current working directory. You can save the current fit results elsewhere by clicking <strong>Save Results</strong> in the ‘qMR data fit’ section of the <em>Menu</em> panel.</li>
<li>Use the controls in the ‘Fit Results’ section to visualize the results (see section 3.3 for details).</li>
</ol>
</div>
</div>
<div class="section" id="viewing-the-fit-results">
<h3>3.3     Viewing the fit results<a class="headerlink" href="#viewing-the-fit-results" title="Permalink to this headline">¶</a></h3>
<p>Once you have finished fitting your qMR data, or when you load previously saved fit results by clicking <strong>Load Results</strong> in the ‘qMT data fit’ section of the <em>Menu</em> panel, the maps will be displayed in the ‘Fit Results’ section. Use controls on the left side of the figure to navigate the maps:</p>
<ul class="simple">
<li><em>Source</em>: select the parameter map to display</li>
<li><em>View</em>: select the side from which to view the data (available only on 3D maps)</li>
<li><em>Slice</em>: navigate through the z direction of the current view (available only on 3D maps)</li>
<li><em>Color Map</em>: choose the color scheme to use from a set of pre-defined Malab colormaps</li>
<li><em>Range</em>: Control the colormap min/max values. Clicking ‘Auto’ will set the min/max values using the min/max of the currently displayed image. Top textbox/slider allows you to manually set the Min value, while bottom textbox/slider are for the Max value</li>
<li><em>Open viewer</em>: open the current data in an external viewer to display simultaneous axial/sagittal/coronal views.</li>
<li><em>Save figure</em>: save the current figure</li>
<li><em>Histogram</em>: open a new window with an histogram of the voxels in the currently selected slice (note that zooming in on a particular section while still produce an histogram of the full slice)</li>
<li><em>View data fit</em>: display raw data + fitted curve of the currently selected voxel (use ‘Cursor’ button to activate voxel selection mode).</li>
<li><em>Pan</em>: change the cursor mode to ‘Pan’. Click and hold inside the figure to move around. Double click inside the figure to reset view. Clicking again the Pan button will turn off pan mode.</li>
<li><em>Zoom</em>: change the cursor mode to ‘Zoom’. Click and hold inside the figure to draw a region to zoom in on. Double click inside the figure to reset view. Clicking again the Zoom button will turn off zoom mode.</li>
<li><em>Select</em>: change the cursor mode to ‘Data Cursor’. Click on a voxel to display info (X/Y is the position of the voxel, index is the value of the map at this point, RGB is the mapped color code).</li>
</ul>
</div>
</div>
<div class="section" id="simulation">
<h2>4.      Simulation<a class="headerlink" href="#simulation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>4.1.    Single Voxel Curve<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The Single Voxel Curve simulation interface allows you to simulate qMR data for the defined parameters and protocol. Once the simulation is done, you can also rapidly test the effect of changing fitting options without having to run the simulation again. It is the fastest way to evaluate various acquisition protocols and the performance of the model and fitting options. A plot of the fitted curve over the actual data will be displayed, and the resulting fitted parameters are compared to the input parameters.</p>
<ol class="arabic simple">
<li>Select the acquisition method of your qMR data using the ‘Method’ drop-down menu in the <em>Menu</em> panel.</li>
<li>In the <em>Menu</em> panel, click on <strong>Single Voxel Curve</strong> to display the interface in the <em>Main</em> panel.</li>
<li>Using the <em>Options</em> panel, define or load the protocol you wish to use (see section 5.1).</li>
<li>Using the <em>Options</em> panel, define or load your initial fitting options (see section 5.2).</li>
<li>Using the <em>Options</em> panel, define or load your simulation parameters (see section 5.3).</li>
<li>In the <em>Menu</em> panel, click on the big <strong>Simulate data</strong> button. A progress bar will appear to show the progression of the simulation. Clicking <strong>Cancel</strong> in the progress bar window will stop the current simulation.</li>
<li>Once the simulation is done, the results are displayed in the <em>Main</em> panel.</li>
<li>If you want to see the effect of changing fitting options, use the <em>Options</em> panel to make your changes. Then, in the <em>Main</em> panel inside the ‘Simulation Fit Results’ panel, click on <strong>Update Fit</strong>. Clicking this button without changing fitting options will also generate a new noisy data distribution and recalculate the fitted curve.</li>
<li>Once the fitting is done, a temporary file (SimCurveTempResults) will be saved in the ‘SimResults’ subfolder of the current active method (e.g. <em>qMTLab/SPGR/SimResults/</em>). You can save the current simulation results by clicking <strong>Save Results</strong> in the ‘qMR Data Simulator fit’ section of the <em>Menu</em> panel. You can later load it using the <strong>Load Results</strong> button.</li>
</ol>
<div class="figure" id="id12">
<a class="reference internal image-reference" href="_images/single_voxel_curve.png"><img alt="_images/single_voxel_curve.png" src="_images/single_voxel_curve.png" style="width: 844.0px; height: 794.0px;" /></a>
<p class="caption"><span class="caption-text">Example result of simulation in 1 voxel. Remember to set options in ‘Options’ panel</span></p>
</div>
</div>
<div class="section" id="id2">
<h3>4.2.    Sensitivity Analysis<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>The Sensitivity Analysis simulation allows you to systematically vary one parameter, over a defined range and number of points, while keeping the others fixed. For each simulated data point, noise is added with a given SNR, and the fit is run multiple times while adding gaussian noise. This allows you to evaluate the variance of the fit at each point. When the simulation is done, a plot shows any variable input parameters as the independent variable, as well as the mean values and variance of any fitted parameters.</p>
<ol class="arabic simple">
<li>Select the acquisition method of your data using the ‘Method’ drop-down menu in the <em>Menu</em> panel.</li>
<li>In the <em>Menu</em> panel, click on <strong>Sensitivity Analysis</strong> to display the interface in the <em>Main</em> panel.</li>
<li>Using the <em>Options</em> panel, define or load the protocol you wish to use (see section 5.1).</li>
<li>Using the <em>Options</em> panel, define or load your fitting options (see section 5.2).</li>
<li>Using the <em>Options</em> panel, define or load your simulation parameters (see section 5.3). The parameters defined here are used as the fixed parameters values as one parameter at a time is systematically varied during the simulation process.</li>
<li>In the <em>Main</em> panel, use the ‘Parameters variation’ table to define your analysis settings. Select the parameters that are to be varied by setting a mark in the appropriate checkbox, set the minimum and maximum values for this parameter under the column ‘Min’ and ‘Max’, and the size of the incrementing step under ‘Step’. Set the number of times you want to add noise and fit for each data point by entering an integer value in the ‘# of runs’ box. These settings can be saved, retrieved or reset to their initial settings using the ‘Save’, ‘Load’ and ‘Reset’ buttons respectively.</li>
<li>In the <em>Menu panel</em>, click on the big <strong>Simulate data</strong> button. A progress bar will appear to show the progression of the simulation. Clicking <strong>Cancel</strong> in the progress bar window will stop the current simulation.</li>
<li>Once the simulation is done, the results are displayed in the ‘Plot Results’ section in the Main panel. Using the ‘x axis’ and ‘y axis’ dropdown menu, you can change the independent/dependant parameters respectively. The parameters that have been varied will be available under the ‘x axis’ menu, while all the model parameters will be available under the ‘y axis’ menu.</li>
<li>A temporary file (SimVaryTempResults) will be saved in the ‘SimResults’ subfolder of the current active method (<em>e.g. qMTLab/SPGR/SimResults/</em>). You can save the current simulation results by clicking <strong>Save Results</strong> in the ‘qMT Data Simulator fit’ section of the <em>Menu panel</em>. You can later load it using the <strong>Load Results</strong> button.</li>
</ol>
<div class="figure" id="id13">
<a class="reference internal image-reference" href="_images/sensitivity_analysis.png"><img alt="_images/sensitivity_analysis.png" src="_images/sensitivity_analysis.png" style="width: 429.0px; height: 428.5px;" /></a>
<p class="caption"><span class="caption-text">Example of sensitivity analysis of the F parameter for qMT</span></p>
</div>
</div>
<div class="section" id="id3">
<h3>4.3. Multi Voxel Distribution<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>The Multi Voxel Distribution is a tool to simulate any number of voxels, where any combination of parameters are allowed to be varied simultaneously. You can choose how many voxels to simulate and which parameters are to be normally distributed, with its mean value and variance. The results can be displayed in a number of ways such as distribution histograms, scatter plots of input vs fitted parameters, error histograms, etc.</p>
<ol class="arabic simple">
<li>Select the acquisition method of your qMR data using the ‘Method’ drop-down menu in the <em>Menu</em> panel.</li>
<li>In the <em>Menu</em> panel, click on <strong>Multi Voxel Distribution</strong> to display the interface in the <em>Main</em> panel.</li>
<li>Using the <em>Options</em> panel, define or load the protocol you wish to use (see section 5.1).</li>
<li>Using the <em>Options</em> panel, define or load your fitting options (see section 5.2).</li>
<li>Using the <em>Options</em> panel, define or load your simulation parameters (see section 5.3). The parameters defined here are used as the fixed parameters values for parameters that are not selected to be varied.</li>
<li>In the <em>Main</em> panel, use the ‘Parameters distribution’ table to define your distribution settings. Select the parameters that are to be varied by setting a mark in the appropriate checkbox, set the mean and standard deviation values for this parameter under the column ‘Mean’ and ‘Std’ respectively. Set the number of voxels you want to simulate by entering an integer value in the ‘# of voxels’ box. These settings can be saved, retrieved or reset to their initial settings using the <strong>Save</strong>, <strong>Load</strong> and <strong>Reset</strong> buttons respectively.</li>
<li>Click on <strong>Get Parameters</strong> in the ‘Parameters distribution’ section to generate a set of normally distributed parameters using the current settings. You can look at the distribution in the ‘Plot Results’ section, by choosing ‘Input parameters’ under the ‘Plot type’ dropdown menu. Select the parameters you want to look at with the ‘x axis’ dropdown menu. You can generate a new set of random values by clicking on the <strong>Get Parameters</strong> button again.</li>
<li>In the <em>Menu</em> panel, click on the big <strong>Simulate data</strong> button. A progress bar will appear to show the progression of the simulation. Clicking <strong>Cancel</strong> in the progress bar window will stop the current simulation.</li>
<li>Once the simulation is done, the results are displayed in the ‘Plot Results’ section in the Main panel. Using the ‘Plot type’ dropdown menu, choose what plot you want to view. Plot types are defined below.</li>
<li>A temporary file (SimRndTempResults) will be saved in the ‘SimResults’ subfolder of the current active method (e.g. qMTLab/SPGR/SimResults/). You can save the current simulation results by clicking ‘Save Results’ in the ‘qMT Data Simulator fit’ section of the Menu panel. You can later load it using the ‘Load Results’ button.</li>
</ol>
<div class="section" id="plot-types">
<h4>Plot types<a class="headerlink" href="#plot-types" title="Permalink to this headline">¶</a></h4>
<p>Different plot types are available to analyze your simulation results. Depending on the plot type, available selections under ‘x axis’ and ‘y axis’ dropdown menus will change accordingly.</p>
<ul class="simple">
<li><em>Input parameters</em>: Histogram of initial input parameters distribution.</li>
<li><em>Fit results</em>: Histogram of fitted parameters distribution.</li>
<li><em>Input vs. Fit</em>: Scatter plot of input parameter value vs fitted value.</li>
<li><em>Error</em>: Histogram of the error distribution. Error is defined as: Fit-Input</li>
<li><em>Pct error</em>: Histogram of the percentage error distribution. Percentage error is defined as: 100×(Fit-Input)/Input</li>
<li><em>MPE</em>: Bar graph of the mean percentage error, defined as: 100/n ∑((Fit-Input)/Input), where n is the number of simulated voxels.</li>
<li><em>RMSE</em>: Bar graph of the root mean squared error, defined as: √(1/n∑(Fit-Input)^2), where n is the number of simulated voxels.</li>
<li><em>NRMSE</em>: Bar graph of the normalized root mean squared error, defined as  RMSE/(max⁡(Input)-min⁡(Input)) , where max(Input) is the maximum value in the input parameter distribution, and min(Input) is the minimum value.</li>
</ul>
<div class="figure" id="id14">
<a class="reference internal image-reference" href="_images/multi-vox-distro.png"><img alt="_images/multi-vox-distro.png" src="_images/multi-vox-distro.png" style="width: 424.5px; height: 428.0px;" /></a>
<p class="caption"><span class="caption-text">Example of MultiVoxel Distribution (option: Input parameters)</span></p>
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>5. Options Panel<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Each qMR acquisition method has its own particular options for simulation, protocol and fitting. These options can be modified by using the <em>Options</em> panel. The <em>Options</em> panel consists of three sub-panels of options: ‘Protocol’, ‘Fitting’ and ‘Options’. At the bottom of all these sub-panels you will find buttons to <strong>Reset</strong> the changes you made, <strong>Save</strong> the current settings as a .mat file, <strong>Load</strong> a .mat file of settings, or go back to the <strong>Default</strong> settings. The <strong>Help</strong> button will open the help for the particular model.</p>
<div class="figure" id="id15">
<a class="reference internal image-reference" href="_images/options-panel.png"><img alt="_images/options-panel.png" src="_images/options-panel.png" style="width: 1200.0px; height: 909.0px;" /></a>
<p class="caption"><span class="caption-text">Example of <em>Options</em> panel for qMT SPGR and Inversion Recovery</span></p>
</div>
<div class="section" id="id5">
<h3>5.1 Protocol<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The ‘Protocol’ panel is where you define all options relating to the acquisition sequence. These options are specific for each method. For all methods, you will find (at the top of the protocol panel) input text fields corresponding to the independent variables. You can also load a previously saved text (.txt) file with the required options and format by using the <strong>Load</strong> button. Press the <strong>Help</strong> button in this panel to see the the format expected by each of the models or by checking examples in:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qMRILab</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="p">{</span><span class="n">ModelName</span><span class="p">}</span><span class="n">_Demo</span><span class="o">/*.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Example: SPGR qMT
The independent variables for this method are the MT pulse power (angles) and offset frequencies. From top to bottom, the protocol panel elements are:</p>
<ul class="simple">
<li><em>Angles</em>: Input text field used to define the MT pulses angles.</li>
<li><em>Offsets</em>: Input text field used to define the offset frequencies.</li>
<li><em>Set sequence</em>: Click this button to fill the sequence table by evaluating the expressions entered in the fields above. The protocol that is used for simulation or data fitting is as it is <em>defined in the sequence table</em>. Input text fields at the top of the protocol panel (above the ‘Set sequence’ button) are there only to give a practical way of quickly filling in the sequence table, without having to enter each point values individually.</li>
<li><em>Sequence table</em>: This table contains the Angles and Offsets values that will be used, in the order they will be used.</li>
<li><em>Add point</em>: Add an empty row below the selected point. If no point in the sequence table is selected, an empty row is added after the last point.</li>
<li><em>Remove point</em>: Remove the selected point. If no point in the sequence table is selected the last point of the sequence is removed.</li>
<li><em>Move up</em>: Move the selected point up in the sequence table.</li>
<li><em>Move down</em>: Move the selected point down in the sequence table.</li>
<li><em>Tmt</em>: Duration of the MT pulses.</li>
<li><em>Ts</em>: Free precession delay between the MT and excitation pulses.</li>
<li><em>Tp</em>: Duration of the excitation pulse.</li>
</ul>
</div>
<div class="section" id="id6">
<h3>5.2.    Fitting<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>The ‘Fitting’ panel is where you determine the upper, lower and starting points of your parameters. You can also select which parameters should be kept fixed for the fitting.</p>
</div>
<div class="section" id="id7">
<h3>5.3. Options<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>The ‘Options’ panel is where you specify the properties of the model and the fitting. For example, the assumptions/type of model (e.g. for SPGR, the SledPikeRP or Yarnykh model), type of images (magnitude or magnitude/phase for Inversion Recovery), etc.</p>
</div>
</div>
<div class="section" id="tutorial">
<h2>6.      Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h2>
<p>Quantitative Magnetization Transfer Imaging using bSSSP</p>
<div class="section" id="define-a-new-bssfp-protocol">
<h3>6.1     Define a new bSSFP protocol<a class="headerlink" href="#define-a-new-bssfp-protocol" title="Permalink to this headline">¶</a></h3>
<p>Suppose you have a bSSFP acquisition protocol that varies alpha from 10° to 45° by a step of 5° with a fixed Trf (free precession time) of 0.3ms followed by 10 variable Trf logarithmically spaced from 0.1ms to 10ms with a fixed alpha of 35° and an additional last point with alpha = 35° and Trf = 25ms. Your sequence uses a fix TR-Trf value of 3ms, and 400 gaussian pulses, with an α/2 – TR/2 prepulse.</p>
<ul class="simple">
<li>Enter “10:5:45” (without quotes) in the ‘Vary alpha’ input text field.</li>
<li>Enter “3e-4” (without quotes) in the ‘Fixed Trf’ input text field.</li>
<li>Enter “logspace(-4,-2,10)” (without quotes) in the ‘Vary Trf’ input text field.</li>
<li>Enter “35” (without quotes) in the ‘Fixed alpha’ input text field.</li>
<li>Click on ‘Set sequence’. The sequence table is automatically filled with.</li>
<li>Click on ‘Add Point’ to add an empty row as the last point in the sequence table.</li>
<li>Edit the values in this last row to “35” and “0.025” in the alpha and Trf columns respectively.</li>
<li>Select the ‘Fix TR-Trf’ radio button and enter 0.003 in the text box below.</li>
<li>Select ‘gaussian’ in the Pulse shape menu.</li>
<li>Enter 400 in the ‘# of RF pulses’ box.</li>
<li>Check the alpha/2 – TR/2 checkbox.</li>
<li>You can now save this protocol for later use by clicking on the ‘Save’ button.</li>
<li>If you want this to be your default protocol, save it as ‘DefaultProt.mat’, replacing the existing file in the /bSSFP/Parameters folder. This protocol will now be loaded by default each time you launch qMTLab, or when you click on ‘Default’ in the Protocol panel.</li>
</ul>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="vfa_t1.html" class="btn btn-neutral" title="Variable Flip Angle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, NeuroPoly.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>